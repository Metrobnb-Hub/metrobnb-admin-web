# Version 1.2.0 - Partner Dashboard Improvements

**Release Date**: December 19, 2024  
**Type**: Feature Enhancement

## ğŸ¯ Overview
Enhanced partner dashboard experience with role-based UI improvements and better invoice status visibility.

## âœ¨ New Features

### Partner Dashboard Enhancements
- **Role-based Invoice Status Labels**: Partners now see user-friendly status labels
  - `draft` â†’ "Being Prepared" 
  - `finalized` â†’ "Almost Ready"
  - `sent` â†’ "For Your Review"
  - `paid` â†’ "All Done âœ“"
- **Recent Invoices Section**: Added invoice preview on partner profile page
- **Action-oriented UI**: Clear call-to-action buttons for invoices requiring partner attention

### Invoice Management Improvements
- **Role-based UI Controls**: 
  - Partners: Hidden archive toggle and create draft button
  - Admins: Full invoice management capabilities
- **Consistent Status Display**: Unified status labels across all invoice views
- **Enhanced Visual Feedback**: Updated status colors for better visibility

### Technical Improvements
- **Fixed API Access**: Resolved `$api is not a function` error in apiClient
- **Improved Error Handling**: Better error messages and fallback states
- **Receipt Display**: Updated to use `receipt_full_url` for proper image display

## ğŸ”§ Technical Changes

### API Integration
- Fixed `useNuxtApp().$api` access pattern in `composables/api.ts`
- Updated expense creation to use FormData with direct file upload
- Enhanced booking edit modal with proper API data loading

### Component Updates
- `pages/partners/[id]/index.vue`: Added invoice section with role-based display
- `pages/invoices/index.vue`: Role-based UI controls and status labels
- `pages/invoices/[id].vue`: Consistent status display across detail view
- `components/expenses/EditExpenseModal.vue`: Fixed field mappings and data loading

### Authentication & Permissions
- Enhanced role-based UI rendering using `useAuth()` composable
- Prepared foundation for future RBAC implementation with `ui_permissions`

## ğŸ“‹ Backend Request
- Created comprehensive documentation for UI permissions system
- Requested `ui_permissions` object in auth responses for better RBAC

## ğŸ› Bug Fixes
- Fixed expense creation file upload workflow
- Resolved partner/unit dropdown loading in edit modals
- Fixed receipt image display using correct URL fields
- Corrected API response data extraction patterns

## ğŸ¨ UI/UX Improvements
- Partner-friendly language throughout invoice interfaces
- Cleaner partner dashboard with hidden admin-only features
- Improved visual hierarchy and action clarity
- Consistent color scheme for status indicators

## ğŸ”„ Migration Notes
- No breaking changes for existing users
- Role-based features automatically apply based on user authentication
- Existing invoice data displays correctly with new status labels

## ğŸ“ˆ Impact
- **Partners**: Cleaner, more intuitive invoice management experience
- **Admins**: Maintained full control with enhanced visual feedback
- **System**: Better separation of concerns between user roles