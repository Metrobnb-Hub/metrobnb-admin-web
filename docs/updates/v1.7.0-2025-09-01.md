# v1.7.0-2025-09-01.md

## Auth composable improvements

- Improved cookie handling for user and organization data, including custom serializers for robust JSON parsing and writing.
- Enhanced logging with a `sanitizeForLog` utility to prevent log injection and redact sensitive fields (e.g., passwords, tokens) from logs.
- Added detailed logging for authentication events: login, logout, token refresh, and restoration from cookies.
- Improved error handling for token refresh and login failures, with automatic redirection to login on 401 or invalid state.
- Added `initializeAuth` method to restore user/organization state from cookies if tokens exist but user data is missing.
- All sensitive data is now cleared from cookies and state on logout or authentication failure.
- Minor refactoring and code comments for clarity and maintainability.

See `composables/useAuth.ts` for implementation details.

## Units Management System Overhaul

### Enhanced Unit Management Interface
- **Responsive grid layout**: Mobile-first design with card-based unit display
- **Advanced filtering**: Search by name, filter by partner and status with debounced search
- **Summary dashboard**: Real-time stats showing total units, active units, occupancy rate, and average revenue
- **Role-based permissions**: Create/edit restrictions based on user role and accessible partners
- **Status management**: Visual status badges (active, inactive, maintenance) with color coding

### Comprehensive Unit Form
- **Multi-section form**: Organized into logical sections (Basic Info, Location, Property Details, Pricing, Amenities, etc.)
- **Advanced property details**: Bedrooms, beds, bathrooms, capacity, and property type
- **Pricing configuration**: Base price, extra guest fees, cleaning fees
- **Location management**: Address, city, building, and nearby landmarks (comma-separated)
- **Amenities handling**: Flexible amenities list with comma-separated input
- **House rules**: Configurable pets, smoking, and parties policies
- **Check-in/Check-out times**: Customizable arrival and departure times
- **Airbnb integration**: URL linking and rating display

### Enhanced Unit Detail View
- **Comprehensive unit profile**: Full unit information with organized sections
- **Visual property showcase**: Property details with emoji icons and clear metrics
- **Amenities display**: Tag-based amenities with proper styling
- **House rules visualization**: Clear allow/disallow indicators with icons
- **Pricing breakdown**: Detailed fee structure display
- **Location information**: Address, landmarks, and nearby points of interest
- **Airbnb integration**: Direct links and rating display

### Technical Improvements
- **Optimized data loading**: Efficient API calls with proper error handling
- **Form validation**: Comprehensive client-side validation with TypeScript types
- **State management**: Integrated with Pinia store for consistent data flow
- **Mobile responsiveness**: Fully responsive design following mobile-first principles
- **Dark mode support**: Complete dark theme compatibility
- **Loading states**: Proper loading indicators and empty states

See `pages/admin/units.vue`, `components/UnitForm.vue`, and `stores/units.ts` for implementation details.
