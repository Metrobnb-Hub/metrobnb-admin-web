import{h as I,r as f,m as M,i as F,c as q,a as l,b as o,w as a,z,j as i,p as D,g as O,f as G,o as P,d,t as u}from"./DNOTuklV.js";import{_ as H}from"./CdEyDy8z.js";import{_ as J}from"./CUyk4a_6.js";import{_ as K}from"./Lwu6USVw.js";import{_ as L,a as Q}from"./8hJOxu5z.js";import{_ as W}from"./BRKyBaGh.js";import{_ as X}from"./BkXjYmYK.js";import{_ as Y}from"./BjgpcN_8.js";import{u as _}from"./DH4W2Tv0.js";import{o as Z,b as ee,c as te,s as oe}from"./NeIn7EVK.js";import"./4gSLflFa.js";import"./DIOUVaTp.js";import"./QRBWpGKc.js";import"./CAAWyulb.js";import"./SYmKFyMt.js";import"./DDOLqT6N.js";import"./B7PN2p1L.js";const ae={class:"max-w-4xl mx-auto space-y-6"},se={class:"flex justify-between items-center"},ne={class:"font-medium"},ie={class:"text-lg font-semibold"},ce={class:"space-y-4"},le={class:"ml-2 text-sm text-gray-600 dark:text-gray-400"},re={class:"flex justify-end space-x-3 mt-6"},Be=I({__name:"booking-sources",setup(me){const{getBookingSources:S,createBookingSource:A,updateBookingSource:g}=D(),p=f([]),r=f(!1),c=f(null),h=Z({name:oe().min(1,"Name is required"),commissionRate:te.number().min(0).max(100).optional(),isActive:ee()}),n=M({name:"",commissionRate:0,isActive:!0}),U=[{key:"name",label:"Name"},{key:"commission_rate",label:"Commission Rate"},{key:"is_active",label:"Status"},{key:"actions",label:""}],V=t=>[[{label:"Edit",icon:"i-heroicons-pencil-square",click:()=>w(t)}],[{label:t.is_active?"Deactivate":"Activate",icon:t.is_active?"i-heroicons-x-circle":"i-heroicons-check-circle",click:()=>B(t)}]],w=t=>{c.value=t,Object.assign(n,{name:t.name,commissionRate:t.commissionRate||0,isActive:t.isActive}),r.value=!0},B=async t=>{try{await g(t.id,{is_active:!t.is_active}),await b(),_().add({title:"Status updated",description:`${t.name} is now ${t.is_active?"inactive":"active"}`,color:"green"})}catch{_().add({title:"Error",description:"Failed to update booking source status",color:"red"})}},x=()=>{r.value=!1,c.value=null,Object.assign(n,{name:"",commissionRate:0,isActive:!0})},R=async()=>{try{if(c.value){const e=await g(c.value.id,n);Object.assign(c.value,e)}else{const e=await A(n);p.value.push(e)}_().add({title:c.value?"Source updated":"Source created",description:`${n.name} has been ${c.value?"updated":"created"} successfully`,color:"green"}),x()}catch{_().add({title:"Error",description:`Failed to ${c.value?"update":"create"} booking source`,color:"red"})}},b=async()=>{const t=await S();console.log("Booking sources API response:",t),p.value=t};return F(async()=>{await b()}),(t,e)=>{const m=O,C=H,$=J,j=K,y=G,k=Q,v=L,T=W,N=X,E=Y;return P(),q("div",ae,[l("div",se,[e[6]||(e[6]=l("div",null,[l("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Booking Sources"),l("p",{class:"text-gray-600 dark:text-gray-400"},"Manage booking sources and commission rates")],-1)),o(m,{onClick:e[0]||(e[0]=s=>r.value=!0),color:"primary"},{default:a(()=>e[5]||(e[5]=[d("Add Source",-1)])),_:1,__:[5]})]),o(y,null,{header:a(()=>e[7]||(e[7]=[l("h3",{class:"text-lg font-semibold"},"All Sources",-1)])),default:a(()=>[o(j,{rows:i(p),columns:U},{"commission_rate-data":a(({row:s})=>[l("span",ne,u(s.commission_rate)+"%",1)]),"is_active-data":a(({row:s})=>[o(C,{color:s.is_active?"green":"red",variant:"subtle"},{default:a(()=>[d(u(s.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"actions-data":a(({row:s})=>[o($,{items:V(s)},{default:a(()=>[o(m,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal",size:"sm"})]),_:2},1032,["items"])]),_:1},8,["rows"])]),_:1}),o(E,{modelValue:i(r),"onUpdate:modelValue":e[4]||(e[4]=s=>z(r)?r.value=s:null)},{default:a(()=>[o(y,null,{header:a(()=>[l("h3",ie,u(i(c)?"Edit":"Add")+" Booking Source",1)]),default:a(()=>[o(N,{schema:i(h),state:i(n),onSubmit:R},{default:a(()=>[l("div",ce,[o(v,{label:"Name",name:"name",required:""},{default:a(()=>[o(k,{modelValue:i(n).name,"onUpdate:modelValue":e[1]||(e[1]=s=>i(n).name=s),placeholder:"e.g., Instagram Ads"},null,8,["modelValue"])]),_:1}),o(v,{label:"Commission Rate (%)",name:"commissionRate"},{default:a(()=>[o(k,{modelValue:i(n).commissionRate,"onUpdate:modelValue":e[2]||(e[2]=s=>i(n).commissionRate=s),type:"number",step:"0.1",min:"0",max:"100"},null,8,["modelValue"])]),_:1}),o(v,{label:"Status",name:"isActive"},{default:a(()=>[o(T,{modelValue:i(n).isActive,"onUpdate:modelValue":e[3]||(e[3]=s=>i(n).isActive=s)},null,8,["modelValue"]),l("span",le,u(i(n).isActive?"Active":"Inactive"),1)]),_:1})]),l("div",re,[o(m,{color:"gray",variant:"ghost",onClick:x},{default:a(()=>e[8]||(e[8]=[d("Cancel",-1)])),_:1,__:[8]}),o(m,{type:"submit",color:"primary"},{default:a(()=>[d(u(i(c)?"Update":"Create")+" Source ",1)]),_:1})])]),_:1},8,["schema","state"])]),_:1})]),_:1},8,["modelValue"])])}}});export{Be as default};
