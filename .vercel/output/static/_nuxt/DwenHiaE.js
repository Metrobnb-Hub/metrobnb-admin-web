import{h as Q,L as W,l as X,r as y,m as Y,n as I,i as Z,c as d,y as tt,s as g,b as s,j as a,a as e,t as m,w as n,z as D,g as et,f as at,p as ot,o as l,d as c,k as st,F as B,q as E}from"./DNOTuklV.js";import{_ as nt}from"./DUuJkhp2.js";import{_ as rt,a as lt}from"./8hJOxu5z.js";import{_ as dt}from"./WinUwd0k.js";import{_ as it}from"./BkXjYmYK.js";import{_ as ut}from"./BjgpcN_8.js";import{u as mt}from"./bwWeQDxp.js";import"./VnKSk5Dv.js";import"./SYmKFyMt.js";import"./BRKyBaGh.js";import"./DIOUVaTp.js";import"./B7PN2p1L.js";import"./NeIn7EVK.js";import"./CAAWyulb.js";import"./QRBWpGKc.js";import"./DH4W2Tv0.js";const pt={class:"max-w-4xl mx-auto"},_t={key:0,class:"flex justify-center py-12"},ct={key:1,class:"space-y-6"},ft={class:"flex justify-between items-start"},xt={class:"text-2xl font-bold text-gray-900 dark:text-white"},yt={class:"flex space-x-3"},gt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},vt={class:"text-gray-900 dark:text-white"},kt={key:0},Ut={class:"text-gray-900 dark:text-white"},bt={class:"text-gray-900 dark:text-white"},wt={key:1},ht={class:"flex flex-wrap gap-2 mt-1"},Vt={class:"flex justify-between items-center"},At={class:"text-lg font-semibold"},Ct={key:0,class:"space-y-4"},$t={class:"flex justify-between items-start"},Pt={class:"flex-1"},Nt={class:"font-medium text-gray-900 dark:text-white"},Ft={key:0,class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},It={key:1,class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},Dt={class:"text-xs text-gray-500 dark:text-gray-500 mt-2"},Bt={class:"flex space-x-2"},Et={key:1,class:"text-center py-8"},jt={class:"text-center py-8"},Lt={class:"space-y-4"},Mt={class:"flex justify-end space-x-3 mt-6"},oe=Q({__name:"index",setup(St){const _=W().params.id,{partners:C,units:$,loadPartners:j,loadUnits:U}=X(),{updateUnit:L,deleteUnit:M}=ot(),{notifySuccess:P,notifyError:N}=mt(),f=y(!0),v=y(!1),x=y(!1),b=y(!1),w=y(null),i=Y({name:"",location:"",notes:""}),p=I(()=>{if(f.value||!_||!Array.isArray(C.value))return null;const r=C.value.find(t=>t.id===_)||null;return console.log("Partner data:",r),r}),h=I(()=>f.value||!_||!Array.isArray($.value)?[]:$.value.filter(r=>(r.partnerId||r.partner_id)===_)||[]),S=r=>{if(!r)return"N/A";try{return new Date(r).toLocaleDateString()}catch{return"Invalid Date"}},z=async()=>{f.value=!0;try{await Promise.all([j(),U()])}catch(r){console.error("Failed to load data:",r)}finally{f.value=!1}},q=r=>{w.value=r,i.name=r.name,i.location=r.location||"",i.notes=r.notes||"",x.value=!0},G=async()=>{if(w.value)try{b.value=!0,await L(w.value.id,i),await U(),x.value=!1,P(`${i.name} has been updated successfully`)}catch{N("Failed to update unit")}finally{b.value=!1}},R=async r=>{if(confirm(`Are you sure you want to delete "${r.name}"?`))try{await M(r.id),await U(),P(`${r.name} has been deleted`)}catch{N("Failed to delete unit")}};return Z(()=>{z()}),(r,t)=>{const u=et,V=st,k=at,T=nt,H=lt,A=rt,F=dt,J=it,K=ut;return l(),d("div",pt,[a(f)?(l(),d("div",_t,t[7]||(t[7]=[e("div",{class:"text-gray-500 dark:text-gray-400"},"Loading...",-1)]))):a(p)?(l(),d("div",ct,[e("div",ft,[e("div",null,[e("h1",xt,m(a(p).name),1),t[8]||(t[8]=e("p",{class:"text-gray-600 dark:text-gray-400"},"Partner Profile",-1))]),e("div",yt,[s(u,{color:"gray",variant:"ghost",to:"/partners"},{default:n(()=>t[9]||(t[9]=[c("Back to Partners",-1)])),_:1,__:[9]}),s(u,{onClick:t[0]||(t[0]=o=>v.value=!0),color:"gray",variant:"outline"},{default:n(()=>[s(V,{name:"i-heroicons-document-text",class:"mr-2"}),t[10]||(t[10]=c(" Generate Invoice ",-1))]),_:1,__:[10]}),s(u,{to:`/partners/${a(_)}/add-unit`,color:"primary"},{default:n(()=>t[11]||(t[11]=[c("Add Unit",-1)])),_:1,__:[11]},8,["to"])])]),s(k,null,{header:n(()=>t[12]||(t[12]=[e("h3",{class:"text-lg font-semibold"},"Partner Information",-1)])),default:n(()=>[e("div",gt,[e("div",null,[t[13]||(t[13]=e("label",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Name",-1)),e("p",vt,m(a(p).name),1)]),a(p).email?(l(),d("div",kt,[t[14]||(t[14]=e("label",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Email",-1)),e("p",Ut,m(a(p).email),1)])):g("",!0),e("div",null,[t[15]||(t[15]=e("label",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Share Percentage",-1)),e("p",bt,m(a(p).share_percentage)+"%",1)]),a(p).services&&a(p).services.length?(l(),d("div",wt,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Services",-1)),e("div",ht,[(l(!0),d(B,null,E(a(p).services,o=>(l(),d("span",{key:o.id||o,class:"inline-flex px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded"},m(typeof o=="string"?o:o.name),1))),128))])])):g("",!0)])]),_:1}),s(k,null,{header:n(()=>[e("div",Vt,[e("h3",At,"Units ("+m(a(h).length)+")",1),s(u,{to:`/partners/${a(_)}/add-unit`,size:"sm",color:"primary"},{default:n(()=>t[17]||(t[17]=[c("Add Unit",-1)])),_:1,__:[17]},8,["to"])])]),default:n(()=>[a(h).length?(l(),d("div",Ct,[(l(!0),d(B,null,E(a(h),o=>(l(),d("div",{key:o.id,class:"p-4 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800"},[e("div",$t,[e("div",Pt,[e("h4",Nt,m(o.name),1),o.location?(l(),d("p",Ft," 📍 "+m(o.location),1)):g("",!0),o.notes?(l(),d("p",It,m(o.notes),1)):g("",!0),e("p",Dt," Added "+m(S(o.createdAt)),1)]),e("div",Bt,[s(u,{onClick:O=>q(o),size:"sm",color:"gray",variant:"ghost"},{default:n(()=>[s(V,{name:"i-heroicons-pencil-square"})]),_:2},1032,["onClick"]),s(u,{onClick:O=>R(o),size:"sm",color:"red",variant:"ghost"},{default:n(()=>[s(V,{name:"i-heroicons-trash"})]),_:2},1032,["onClick"])])])]))),128))])):(l(),d("div",Et,[t[19]||(t[19]=e("p",{class:"text-gray-500 dark:text-gray-400 mb-4"},"No units added yet",-1)),s(u,{to:`/partners/${a(_)}/add-unit`,color:"primary"},{default:n(()=>t[18]||(t[18]=[c("Add First Unit",-1)])),_:1,__:[18]},8,["to"])]))]),_:1})])):a(f)?g("",!0):(l(),tt(k,{key:2},{default:n(()=>[e("div",jt,[t[21]||(t[21]=e("p",{class:"text-gray-500 dark:text-gray-400"},"Partner not found",-1)),s(u,{to:"/partners",class:"mt-4"},{default:n(()=>t[20]||(t[20]=[c("Back to Partners",-1)])),_:1,__:[20]})])]),_:1})),s(T,{modelValue:a(v),"onUpdate:modelValue":t[1]||(t[1]=o=>D(v)?v.value=o:null),"preselected-partner-id":a(_)},null,8,["modelValue","preselected-partner-id"]),s(K,{modelValue:a(x),"onUpdate:modelValue":t[6]||(t[6]=o=>D(x)?x.value=o:null)},{default:n(()=>[s(k,null,{header:n(()=>t[22]||(t[22]=[e("h3",{class:"text-lg font-semibold"},"Edit Unit",-1)])),default:n(()=>[s(J,{state:a(i),onSubmit:G},{default:n(()=>[e("div",Lt,[s(A,{label:"Unit Name",required:""},{default:n(()=>[s(H,{modelValue:a(i).name,"onUpdate:modelValue":t[2]||(t[2]=o=>a(i).name=o),placeholder:"Enter unit name"},null,8,["modelValue"])]),_:1}),s(A,{label:"Location"},{default:n(()=>[s(F,{modelValue:a(i).location,"onUpdate:modelValue":t[3]||(t[3]=o=>a(i).location=o),placeholder:"Enter unit location"},null,8,["modelValue"])]),_:1}),s(A,{label:"Notes"},{default:n(()=>[s(F,{modelValue:a(i).notes,"onUpdate:modelValue":t[4]||(t[4]=o=>a(i).notes=o),placeholder:"Additional notes"},null,8,["modelValue"])]),_:1})]),e("div",Mt,[s(u,{color:"gray",variant:"ghost",onClick:t[5]||(t[5]=o=>x.value=!1)},{default:n(()=>t[23]||(t[23]=[c("Cancel",-1)])),_:1,__:[23]}),s(u,{type:"submit",color:"primary",loading:a(b)},{default:n(()=>t[24]||(t[24]=[c("Update Unit",-1)])),_:1,__:[24]},8,["loading"])])]),_:1},8,["state"])]),_:1})]),_:1},8,["modelValue"])])}}});export{oe as default};
