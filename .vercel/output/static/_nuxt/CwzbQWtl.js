import{h as K,l as Q,r as v,n as h,i as W,c as u,M as X,a as e,b as o,w as n,p as Y,f as Z,o as m,k as tt,t as l,j as c,z as U,s as et,F as st,q as at,y as ot,g as nt,d as x,A as lt}from"./DNOTuklV.js";import{_ as it}from"./VnKSk5Dv.js";import{_ as rt}from"./CUyk4a_6.js";import{_ as ct}from"./CdEyDy8z.js";import{_ as dt}from"./Lwu6USVw.js";import{u as y}from"./bwWeQDxp.js";import"./SYmKFyMt.js";import"./4gSLflFa.js";import"./DIOUVaTp.js";import"./QRBWpGKc.js";import"./CAAWyulb.js";import"./DDOLqT6N.js";import"./DH4W2Tv0.js";const mt={class:"space-y-3 sm:space-y-6"},ut={class:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4"},pt={class:"flex items-center"},_t={class:"p-2 sm:p-3 bg-blue-100 dark:bg-blue-900 rounded-lg"},gt={class:"ml-2 sm:ml-4 min-w-0 flex-1"},xt={class:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white truncate"},yt={class:"flex items-center"},ft={class:"p-2 sm:p-3 bg-orange-100 dark:bg-orange-900 rounded-lg"},vt={class:"ml-2 sm:ml-4 min-w-0 flex-1"},ht={class:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white truncate"},kt={class:"flex items-center"},bt={class:"p-2 sm:p-3 bg-green-100 dark:bg-green-900 rounded-lg"},wt={class:"ml-2 sm:ml-4 min-w-0 flex-1"},It={class:"text-lg sm:text-2xl font-bold text-gray-900 dark:text-white truncate"},At={class:"mb-4 flex flex-col sm:flex-row gap-2 sm:gap-4"},St={key:0,class:"flex justify-center py-8"},Pt={key:1},Ft={key:0,class:"sm:hidden space-y-3"},Vt={class:"space-y-3"},Ut={class:"flex justify-between items-start"},Ct={class:"min-w-0 flex-1"},Dt={class:"font-medium text-gray-900 dark:text-white truncate"},zt={class:"text-sm text-gray-500 dark:text-gray-400 truncate"},Nt={class:"grid grid-cols-2 gap-3 text-sm"},Bt={class:"font-medium"},Et={class:"font-medium text-red-600 dark:text-red-400"},Lt={class:"font-medium"},jt={key:1,class:"hidden sm:block"},Mt={class:"font-medium text-gray-900 dark:text-white"},Tt={class:"text-sm text-gray-500 dark:text-gray-400"},Gt={class:"font-semibold text-red-600 dark:text-red-400"},Ot={key:2,class:"text-center py-12"},ae=K({__name:"index",setup($t){const{getInvoices:C,settleInvoice:D,deleteInvoice:z,cancelInvoice:N,regenerateInvoice:B}=Y(),{partners:w,loadPartners:E}=Q(),d=v([]),k=v(!1),p=v("all"),_=v("all"),L=[{label:"All Status",value:"all"},{label:"Pending",value:"pending"},{label:"Paid",value:"paid"},{label:"Cancelled",value:"cancelled"}],j=h(()=>{const s=[{label:"All Partners",value:"all"}];return Array.isArray(w.value)&&s.push(...w.value.map(t=>({label:t.name,value:t.id}))),s}),M=[{key:"invoice_number",label:"Invoice / Partner"},{key:"period",label:"Period"},{key:"amount",label:"Amount"},{key:"status",label:"Status"},{key:"generated_at",label:"Generated"},{key:"actions",label:""}],f=h(()=>{if(!Array.isArray(d.value))return[];let s=d.value;return p.value!=="all"&&(s=s.filter(t=>t.status===p.value)),_.value!=="all"&&(s=s.filter(t=>t.partner_id===_.value)),s}),T=h(()=>Array.isArray(d.value)?d.value.filter(s=>s.status==="pending").length:0),G=h(()=>Array.isArray(d.value)?d.value.filter(s=>s.status==="paid").length:0),I=s=>({pending:"orange",paid:"green",cancelled:"red"})[s]||"gray",A=s=>new Date(s).toLocaleDateString(),S=s=>{const t=[[{label:"View Invoice",icon:"i-heroicons-eye",click:()=>O(s)}]];return s.status==="pending"&&(t.push([{label:"Mark as Paid",icon:"i-heroicons-check-circle",click:()=>$(s)},{label:"Regenerate",icon:"i-heroicons-arrow-path",click:()=>R(s)}]),t.push([{label:"Cancel",icon:"i-heroicons-x-circle",click:()=>q(s)},{label:"Delete",icon:"i-heroicons-trash",click:()=>H(s)}])),t},O=s=>{lt(`/invoices/${s.id}`)},$=async s=>{const{notifySuccess:t,notifyError:i}=y();try{await D(s.id,new Date().toISOString().split("T")[0]),await g(),t("Invoice marked as paid successfully")}catch{i("Failed to mark invoice as paid")}},R=async s=>{const{notifySuccess:t,notifyError:i}=y();try{const r=await B(s.id);await g(),t(`Invoice regenerated: ${r.data.invoice_number}`)}catch{i("Failed to regenerate invoice")}},q=async s=>{const{notifySuccess:t,notifyError:i}=y();try{await N(s.id),await g(),t("Invoice cancelled successfully")}catch{i("Failed to cancel invoice")}},H=async s=>{const{notifySuccess:t,notifyError:i}=y();try{await z(s.id),await g(),t("Invoice deleted successfully")}catch{i("Failed to delete invoice")}},g=async()=>{try{k.value=!0;const s=await C();d.value=s.items||s||[]}catch(s){console.error("Failed to load invoices:",s),d.value=[];const{notifyError:t}=y();t("Failed to load invoices")}finally{k.value=!1}};return W(async()=>{await Promise.all([E(),g()])}),(s,t)=>{const i=tt,r=Z,P=it,b=nt,F=rt,V=ct,J=dt;return m(),u("div",mt,[t[14]||(t[14]=X('<div class="space-y-3"><div class="flex justify-between items-start gap-3"><div class="min-w-0 flex-1"><h1 class="text-xl sm:text-2xl font-bold text-gray-900 dark:text-white truncate">Invoices</h1><p class="text-sm text-gray-600 dark:text-gray-400 hidden sm:block">Manage partner invoices and settlements</p></div></div></div>',1)),e("div",ut,[o(r,{class:"p-3 sm:p-4"},{default:n(()=>{var a;return[e("div",pt,[e("div",_t,[o(i,{name:"i-heroicons-document-text",class:"h-4 w-4 sm:h-6 sm:w-6 text-blue-600 dark:text-blue-400"})]),e("div",gt,[t[2]||(t[2]=e("p",{class:"text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-400"},"Total",-1)),e("p",xt,l(((a=c(d))==null?void 0:a.length)||0),1)])])]}),_:1}),o(r,{class:"p-3 sm:p-4"},{default:n(()=>[e("div",yt,[e("div",ft,[o(i,{name:"i-heroicons-clock",class:"h-4 w-4 sm:h-6 sm:w-6 text-orange-600 dark:text-orange-400"})]),e("div",vt,[t[3]||(t[3]=e("p",{class:"text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-400"},"Pending",-1)),e("p",ht,l(c(T)),1)])])]),_:1}),o(r,{class:"p-3 sm:p-4 col-span-2 sm:col-span-1"},{default:n(()=>[e("div",kt,[e("div",bt,[o(i,{name:"i-heroicons-check-circle",class:"h-4 w-4 sm:h-6 sm:w-6 text-green-600 dark:text-green-400"})]),e("div",wt,[t[4]||(t[4]=e("p",{class:"text-xs sm:text-sm font-medium text-gray-600 dark:text-gray-400"},"Paid",-1)),e("p",It,l(c(G)),1)])])]),_:1})]),o(r,null,{header:n(()=>t[5]||(t[5]=[e("div",{class:"flex justify-between items-center"},[e("h3",{class:"text-lg font-semibold"},"All Invoices")],-1)])),default:n(()=>[e("div",At,[o(P,{modelValue:c(p),"onUpdate:modelValue":t[0]||(t[0]=a=>U(p)?p.value=a:null),options:L,class:"flex-1 sm:w-40",size:"sm"},null,8,["modelValue"]),o(P,{modelValue:c(_),"onUpdate:modelValue":t[1]||(t[1]=a=>U(_)?_.value=a:null),options:c(j),class:"flex-1 sm:w-48",size:"sm"},null,8,["modelValue","options"])]),c(k)?(m(),u("div",St,t[6]||(t[6]=[e("div",{class:"text-gray-500"},"Loading invoices...",-1)]))):(m(),u("div",Pt,[c(f).length?(m(),u("div",Ft,[(m(!0),u(st,null,at(c(f),a=>(m(),ot(r,{key:a.id,class:"p-4"},{default:n(()=>[e("div",Vt,[e("div",Ut,[e("div",Ct,[e("h3",Dt,l(a.invoice_number),1),e("p",zt,l(a.partner_name),1)]),o(F,{items:S(a)},{default:n(()=>[o(b,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal",size:"xs"})]),_:2},1032,["items"])]),e("div",Nt,[e("div",null,[t[7]||(t[7]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Period:",-1)),e("p",Bt,l(a.period),1)]),e("div",null,[t[8]||(t[8]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Amount:",-1)),e("p",Et,"₱"+l(parseFloat(a.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})),1)]),e("div",null,[t[9]||(t[9]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Status:",-1)),o(V,{color:I(a.status),size:"xs",class:"ml-1"},{default:n(()=>[x(l(a.status),1)]),_:2},1032,["color"])]),e("div",null,[t[10]||(t[10]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Generated:",-1)),e("p",Lt,l(A(a.generated_at)),1)])])])]),_:2},1024))),128))])):et("",!0),c(f).length?(m(),u("div",jt,[o(J,{rows:c(f),columns:M},{"invoice_number-data":n(({row:a})=>[e("div",null,[e("div",Mt,l(a.invoice_number),1),e("div",Tt,l(a.partner_name),1)])]),"period-data":n(({row:a})=>[x(l(a.period),1)]),"amount-data":n(({row:a})=>[e("span",Gt," ₱"+l(parseFloat(a.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})),1)]),"status-data":n(({row:a})=>[o(V,{color:I(a.status),size:"xs"},{default:n(()=>[x(l(a.status),1)]),_:2},1032,["color"])]),"generated_at-data":n(({row:a})=>[x(l(A(a.generated_at)),1)]),"actions-data":n(({row:a})=>[o(F,{items:S(a)},{default:n(()=>[o(b,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal",size:"sm"})]),_:2},1032,["items"])]),_:1},8,["rows"])])):(m(),u("div",Ot,[t[12]||(t[12]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"No invoices yet",-1)),t[13]||(t[13]=e("p",{class:"text-gray-600 dark:text-gray-400 mb-6"},"Generate your first invoice from the partners page",-1)),o(b,{to:"/partners",color:"primary"},{default:n(()=>t[11]||(t[11]=[x("Go to Partners",-1)])),_:1,__:[11]})]))]))]),_:1})])}}});export{ae as default};
