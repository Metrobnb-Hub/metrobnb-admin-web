import{_ as T}from"./VnKSk5Dv.js";import{_ as w,a as C}from"./8hJOxu5z.js";import{_ as M}from"./BRKyBaGh.js";import{_ as R}from"./WinUwd0k.js";import{h as D,l as O,N as F,r as c,n as b,x as P,i as k,c as L,b as t,w as s,f as W,p as h,o as j,j as l,a as u,t as q,g as G,d as $}from"./DNOTuklV.js";import{_ as z}from"./BkXjYmYK.js";import{u as H}from"./DH4W2Tv0.js";import{u as J}from"./bwWeQDxp.js";import"./SYmKFyMt.js";import"./DIOUVaTp.js";import"./B7PN2p1L.js";import"./CAAWyulb.js";const K={class:"space-y-6"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Z={class:"ml-2 text-sm text-gray-600"},_e=D({__name:"create",setup(ee){const{partners:p,units:m,loadPartners:f,loadUnits:v}=O(),{createExpense:y}=h(),g=F();H();const i=c(!1),e=c({partnerId:"",unitId:"",date:new Date().toISOString().split("T")[0],type:"",amount:0,billable:!0,notes:""}),x=b(()=>Array.isArray(p.value)?p.value.map(o=>({label:o.name,value:o.id})):[]),V=b(()=>!e.value.partnerId||!Array.isArray(m.value)?[]:m.value.filter(o=>o.partner_id===e.value.partnerId).map(o=>({label:o.name,value:o.id}))),I=[{label:"Cleaning",value:"Cleaning"},{label:"Laundry",value:"Laundry"},{label:"Supplies",value:"Supplies"},{label:"Wifi",value:"Wifi"},{label:"Electricity",value:"Electricity"},{label:"Repair",value:"Repair"},{label:"Repairs",value:"Repairs"},{label:"Miscellaneous",value:"Miscellaneous"}],U=async()=>{const{notifySuccess:o,notifyError:a}=J();if(!e.value.partnerId||!e.value.unitId||!e.value.type||!e.value.amount){a("Please fill in all required fields");return}i.value=!0;try{await y({partner_id:e.value.partnerId,unit_id:e.value.unitId,date:e.value.date,type:e.value.type,amount:Number(e.value.amount),billable:e.value.billable,notes:e.value.notes}),o("Expense added successfully"),g.push("/expenses")}catch{a("Failed to add expense")}finally{i.value=!1}};return P(()=>e.value.partnerId,(o,a)=>{a&&o!==a&&(e.value.unitId="")}),k(async()=>{await Promise.all([f(),v()])}),(o,a)=>{const d=T,r=w,_=C,S=M,A=R,B=G,E=z,N=W;return j(),L("div",K,[t(N,null,{header:s(()=>a[7]||(a[7]=[u("h3",{class:"text-lg font-semibold"},"Add Expense",-1)])),default:s(()=>[t(E,{state:l(e),onSubmit:U,class:"space-y-4"},{default:s(()=>[u("div",Q,[t(r,{label:"Partner",name:"partnerId"},{default:s(()=>[t(d,{modelValue:l(e).partnerId,"onUpdate:modelValue":a[0]||(a[0]=n=>l(e).partnerId=n),options:l(x),placeholder:"Select partner"},null,8,["modelValue","options"])]),_:1}),t(r,{label:"Unit",name:"unitId"},{default:s(()=>[t(d,{modelValue:l(e).unitId,"onUpdate:modelValue":a[1]||(a[1]=n=>l(e).unitId=n),options:l(V),placeholder:"Select unit",disabled:!l(e).partnerId},null,8,["modelValue","options","disabled"])]),_:1})]),u("div",X,[t(r,{label:"Date",name:"date"},{default:s(()=>[t(_,{modelValue:l(e).date,"onUpdate:modelValue":a[2]||(a[2]=n=>l(e).date=n),type:"date"},null,8,["modelValue"])]),_:1}),t(r,{label:"Type",name:"type"},{default:s(()=>[t(d,{modelValue:l(e).type,"onUpdate:modelValue":a[3]||(a[3]=n=>l(e).type=n),options:I,placeholder:"Select type"},null,8,["modelValue"])]),_:1})]),u("div",Y,[t(r,{label:"Amount",name:"amount"},{default:s(()=>[t(_,{modelValue:l(e).amount,"onUpdate:modelValue":a[4]||(a[4]=n=>l(e).amount=n),type:"number",step:"0.01",placeholder:"0.00"},null,8,["modelValue"])]),_:1}),t(r,{label:"Billable",name:"billable"},{default:s(()=>[t(S,{modelValue:l(e).billable,"onUpdate:modelValue":a[5]||(a[5]=n=>l(e).billable=n)},null,8,["modelValue"]),u("span",Z,q(l(e).billable?"Bill to partner":"MetroBNB absorbs"),1)]),_:1})]),t(r,{label:"Notes",name:"notes"},{default:s(()=>[t(A,{modelValue:l(e).notes,"onUpdate:modelValue":a[6]||(a[6]=n=>l(e).notes=n),placeholder:"Optional notes"},null,8,["modelValue"])]),_:1}),t(B,{type:"submit",loading:l(i)},{default:s(()=>a[8]||(a[8]=[$("Add Expense",-1)])),_:1,__:[8]},8,["loading"])]),_:1},8,["state"])]),_:1})])}}});export{_e as default};
