import{_ as P}from"./q5FFsa6R.js";import{h as $,c as g,o as p,b as o,a as i,k as G,t as B,y as U,s as S,w as s,d as x,g as q,l as O,N as W,L as z,r as w,m as K,n as Q,i as X,j as n,p as Y,f as Z}from"./DNOTuklV.js";import{_ as ee}from"./VnKSk5Dv.js";import{_ as te,a as oe}from"./8hJOxu5z.js";import{_ as ne}from"./WinUwd0k.js";import{_ as ae}from"./BkXjYmYK.js";import{u as re}from"./bwWeQDxp.js";import{o as se,s as _,c as le,e as de}from"./NeIn7EVK.js";import"./SYmKFyMt.js";import"./CAAWyulb.js";import"./DH4W2Tv0.js";const ie={class:"text-center py-12"},ue={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},me={class:"text-gray-500 dark:text-gray-400 mb-6"},pe={class:"space-x-3"},ce=$({__name:"ErrorState",props:{title:{default:"Something went wrong"},message:{default:"We encountered an error while loading this page."},showRetry:{type:Boolean,default:!0},showHome:{type:Boolean,default:!0}},emits:["retry"],setup(C){return(u,d)=>{const c=G,y=q;return p(),g("div",ie,[o(c,{name:"i-heroicons-exclamation-triangle",class:"mx-auto h-12 w-12 text-red-500 mb-4"}),i("h3",ue,B(u.title),1),i("p",me,B(u.message),1),i("div",pe,[u.showRetry?(p(),U(y,{key:0,onClick:d[0]||(d[0]=k=>u.$emit("retry")),color:"primary"},{default:s(()=>[o(c,{name:"i-heroicons-arrow-path",class:"mr-2"}),d[1]||(d[1]=x(" Try Again ",-1))]),_:1,__:[1]})):S("",!0),u.showHome?(p(),U(y,{key:1,to:"/dashboard",color:"gray"},{default:s(()=>[o(c,{name:"i-heroicons-home",class:"mr-2"}),d[2]||(d[2]=x(" Go Home ",-1))]),_:1,__:[2]})):S("",!0)])])}}}),_e={class:"max-w-2xl mx-auto space-y-6"},ye={key:0,class:"text-center py-8"},fe={key:1,class:"text-center py-8"},ge={class:"space-y-4"},xe={class:"flex justify-end space-x-3 mt-6"},Be=$({__name:"edit",setup(C){const{partners:u,loadPartners:d}=O(),{getJournalEntries:c,updateJournalEntry:y}=Y(),{notifySuccess:k,notifyError:b}=re(),R=W(),E=z().params.id,V=w(!0),v=w(!1),I=w(null),T=se({partnerId:_().min(1,"Partner is required"),type:de(["credit","debit"]),date:_().min(1,"Date is required"),amount:le.number().min(.01,"Amount must be greater than 0"),description:_().min(1,"Description is required"),reference:_().optional(),notes:_().optional()}),e=K({partnerId:"",type:"credit",date:"",amount:0,description:"",reference:"",notes:""}),N=Q(()=>u.value.map(a=>({label:a.name,value:a.id}))),F=[{label:"Credit (+) - Money owed to partner",value:"credit"},{label:"Debit (-) - Money owed by partner",value:"debit"}],j=async()=>{try{V.value=!0,await d();const a=await c();let t=[];a&&a.data?t=Array.isArray(a.data.items)?a.data.items:[]:t=Array.isArray(a)?a:[];const l=t.find(h=>h.id===E);if(!l){b("Journal entry not found");return}I.value=l,e.partnerId=l.partner_id,e.type=l.type,e.date=l.date,e.amount=parseFloat(l.amount),e.description=l.description,e.reference=l.reference||"",e.notes=l.notes||""}catch{b("Failed to load journal entry")}finally{V.value=!1}},J=async()=>{try{v.value=!0;const a={partner_id:e.partnerId,type:e.type,date:e.date,amount:e.amount,description:e.description,reference:e.reference||void 0,notes:e.notes||void 0};await y(E,a),k(`${e.type==="credit"?"Credit":"Debit"} entry updated successfully`),R.push("/journal-entries")}catch{b("Failed to update journal entry")}finally{v.value=!1}};return X(j),(a,t)=>{const l=P,h=ce,D=ee,m=te,f=oe,M=ne,A=q,H=ae,L=Z;return p(),g("div",_e,[t[9]||(t[9]=i("div",null,[i("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Edit Journal Entry"),i("p",{class:"text-gray-600 dark:text-gray-400"},"Update journal entry details")],-1)),n(V)?(p(),g("div",ye,[o(l,{message:"Loading journal entry..."})])):n(I)?(p(),U(L,{key:2},{default:s(()=>[o(H,{schema:n(T),state:n(e),onSubmit:J},{default:s(()=>[i("div",ge,[o(m,{label:"Partner",name:"partnerId",required:""},{default:s(()=>[o(D,{modelValue:n(e).partnerId,"onUpdate:modelValue":t[0]||(t[0]=r=>n(e).partnerId=r),options:n(N),placeholder:"Select partner"},null,8,["modelValue","options"])]),_:1}),o(m,{label:"Entry Type",name:"type",required:""},{default:s(()=>[o(D,{modelValue:n(e).type,"onUpdate:modelValue":t[1]||(t[1]=r=>n(e).type=r),options:F},null,8,["modelValue"])]),_:1}),o(m,{label:"Date",name:"date",required:""},{default:s(()=>[o(f,{modelValue:n(e).date,"onUpdate:modelValue":t[2]||(t[2]=r=>n(e).date=r),type:"date"},null,8,["modelValue"])]),_:1}),o(m,{label:"Amount",name:"amount",required:""},{default:s(()=>[o(f,{modelValue:n(e).amount,"onUpdate:modelValue":t[3]||(t[3]=r=>n(e).amount=r),type:"number",step:"0.01",min:"0",placeholder:"0.00"},null,8,["modelValue"])]),_:1}),o(m,{label:"Description",name:"description",required:""},{default:s(()=>[o(f,{modelValue:n(e).description,"onUpdate:modelValue":t[4]||(t[4]=r=>n(e).description=r),placeholder:"Brief description of the entry"},null,8,["modelValue"])]),_:1}),o(m,{label:"Reference",name:"reference"},{default:s(()=>[o(f,{modelValue:n(e).reference,"onUpdate:modelValue":t[5]||(t[5]=r=>n(e).reference=r),placeholder:"Reference number or ID (optional)"},null,8,["modelValue"])]),_:1}),o(m,{label:"Notes",name:"notes"},{default:s(()=>[o(M,{modelValue:n(e).notes,"onUpdate:modelValue":t[6]||(t[6]=r=>n(e).notes=r),placeholder:"Additional notes (optional)",rows:3},null,8,["modelValue"])]),_:1})]),i("div",xe,[o(A,{color:"gray",variant:"ghost",to:"/journal-entries"},{default:s(()=>t[7]||(t[7]=[x("Cancel",-1)])),_:1,__:[7]}),o(A,{type:"submit",color:"primary",loading:n(v)},{default:s(()=>t[8]||(t[8]=[x("Update Entry",-1)])),_:1,__:[8]},8,["loading"])])]),_:1},8,["schema","state"])]),_:1})):(p(),g("div",fe,[o(h,{title:"Entry not found",message:"The journal entry you're looking for doesn't exist.","show-retry":!1,onRetry:j})]))])}}});export{Be as default};
