import{h as z,c as g,o as y,b as o,a as t,y as W,s as X,k as Y,t as p,w as i,d as N,g as G,a7 as K,l as Z,a8 as ie,r as k,m as de,n as V,x as Q,j as r,f as ee,p as te,i as ce,z as R,v as O,F as ue,q as pe}from"./DNOTuklV.js";import{_ as ae}from"./VnKSk5Dv.js";import{_ as me}from"./q5FFsa6R.js";import{_ as ye}from"./CUyk4a_6.js";import{_ as _e,a as xe}from"./8hJOxu5z.js";import{_ as ge}from"./WinUwd0k.js";import{_ as fe}from"./BkXjYmYK.js";import{_ as ve}from"./BjgpcN_8.js";import{u as oe}from"./bwWeQDxp.js";import{o as be,s as A,c as he,e as ke}from"./NeIn7EVK.js";import"./SYmKFyMt.js";import"./4gSLflFa.js";import"./DIOUVaTp.js";import"./QRBWpGKc.js";import"./CAAWyulb.js";import"./B7PN2p1L.js";import"./DH4W2Tv0.js";const we={class:"text-center py-12"},Ve={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},Ue={class:"text-gray-500 dark:text-gray-400 mb-6"},Ee=z({__name:"EmptyState",props:{icon:{default:"i-heroicons-inbox"},title:{},message:{},actionText:{},actionTo:{},actionIcon:{default:"i-heroicons-plus"}},setup(S){return(u,j)=>{const w=Y,U=G;return y(),g("div",we,[o(w,{name:u.icon,class:"mx-auto h-12 w-12 text-gray-400 mb-4"},null,8,["name"]),t("h3",Ve,p(u.title),1),t("p",Ue,p(u.message),1),u.actionText&&u.actionTo?(y(),W(U,{key:0,to:u.actionTo,color:"primary"},{default:i(()=>[o(w,{name:u.actionIcon,class:"mr-2"},null,8,["name"]),N(" "+p(u.actionText),1)]),_:1},8,["to"])):X("",!0)])}}}),De={class:"space-y-4"},Te={class:"flex justify-end space-x-3 mt-6"},Ce=z({__name:"EditModal",props:K({entry:{}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:K(["updated"],["update:modelValue"]),setup(S,{emit:u}){const{partners:j}=Z(),{updateJournalEntry:w}=te(),{notifySuccess:U,notifyError:P}=oe(),x=ie(S,"modelValue"),f=k(!1),l=S,v=u,b=be({partnerId:A().min(1,"Partner is required"),type:ke(["credit","debit"]),date:A().min(1,"Date is required"),amount:he.number().min(.01,"Amount must be greater than 0"),description:A().min(1,"Description is required"),reference:A().optional(),notes:A().optional()}),n=de({partnerId:"",type:"credit",date:"",amount:0,description:"",reference:"",notes:""}),F=V(()=>j.value.map(m=>({label:m.name,value:m.id}))),q=[{label:"Credit (+) - Money owed to partner",value:"credit"},{label:"Debit (-) - Money owed by partner",value:"debit"}],M=()=>{l.entry&&(n.partnerId=l.entry.partner_id,n.type=l.entry.type,n.date=l.entry.date,n.amount=parseFloat(l.entry.amount),n.description=l.entry.description,n.reference=l.entry.reference||"",n.notes=l.entry.notes||"")},$=async()=>{if(l.entry)try{f.value=!0;const m={partner_id:n.partnerId,type:n.type,date:n.date,amount:n.amount,description:n.description,reference:n.reference||void 0,notes:n.notes||void 0};await w(l.entry.id,m),U(`${n.type==="credit"?"Credit":"Debit"} entry updated successfully`),x.value=!1,v("updated")}catch{P("Failed to update journal entry")}finally{f.value=!1}};return Q(()=>l.entry,M,{immediate:!0}),Q(x,m=>{m&&M()}),(m,s)=>{const E=ae,_=_e,h=xe,D=ge,B=G,L=fe,J=ee,T=ve;return y(),W(T,{modelValue:x.value,"onUpdate:modelValue":s[8]||(s[8]=e=>x.value=e)},{default:i(()=>[o(J,null,{header:i(()=>s[9]||(s[9]=[t("h3",{class:"text-lg font-semibold"},"Edit Journal Entry",-1)])),default:i(()=>[o(L,{schema:r(b),state:r(n),onSubmit:$},{default:i(()=>[t("div",De,[o(_,{label:"Partner",name:"partnerId",required:""},{default:i(()=>[o(E,{modelValue:r(n).partnerId,"onUpdate:modelValue":s[0]||(s[0]=e=>r(n).partnerId=e),options:r(F),placeholder:"Select partner"},null,8,["modelValue","options"])]),_:1}),o(_,{label:"Entry Type",name:"type",required:""},{default:i(()=>[o(E,{modelValue:r(n).type,"onUpdate:modelValue":s[1]||(s[1]=e=>r(n).type=e),options:q},null,8,["modelValue"])]),_:1}),o(_,{label:"Date",name:"date",required:""},{default:i(()=>[o(h,{modelValue:r(n).date,"onUpdate:modelValue":s[2]||(s[2]=e=>r(n).date=e),type:"date"},null,8,["modelValue"])]),_:1}),o(_,{label:"Amount",name:"amount",required:""},{default:i(()=>[o(h,{modelValue:r(n).amount,"onUpdate:modelValue":s[3]||(s[3]=e=>r(n).amount=e),type:"number",step:"0.01",min:"0",placeholder:"0.00"},null,8,["modelValue"])]),_:1}),o(_,{label:"Description",name:"description",required:""},{default:i(()=>[o(h,{modelValue:r(n).description,"onUpdate:modelValue":s[4]||(s[4]=e=>r(n).description=e),placeholder:"Brief description of the entry"},null,8,["modelValue"])]),_:1}),o(_,{label:"Reference",name:"reference"},{default:i(()=>[o(h,{modelValue:r(n).reference,"onUpdate:modelValue":s[5]||(s[5]=e=>r(n).reference=e),placeholder:"Reference number or ID (optional)"},null,8,["modelValue"])]),_:1}),o(_,{label:"Notes",name:"notes"},{default:i(()=>[o(D,{modelValue:r(n).notes,"onUpdate:modelValue":s[6]||(s[6]=e=>r(n).notes=e),placeholder:"Additional notes (optional)",rows:3},null,8,["modelValue"])]),_:1})]),t("div",Te,[o(B,{color:"gray",variant:"ghost",onClick:s[7]||(s[7]=e=>x.value=!1)},{default:i(()=>s[10]||(s[10]=[N("Cancel",-1)])),_:1,__:[10]}),o(B,{type:"submit",color:"primary",loading:r(f)},{default:i(()=>s[11]||(s[11]=[N("Update Entry",-1)])),_:1,__:[11]},8,["loading"])])]),_:1},8,["schema","state"])]),_:1})]),_:1},8,["modelValue"])}}}),Ae={class:"space-y-6"},Se={class:"flex justify-between items-center"},je={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},Fe={class:"flex items-center"},Me={class:"p-3 bg-green-100 dark:bg-green-900 rounded-lg"},$e={class:"ml-4"},Be={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ie={class:"flex items-center"},Ne={class:"p-3 bg-red-100 dark:bg-red-900 rounded-lg"},Pe={class:"ml-4"},qe={class:"text-2xl font-bold text-gray-900 dark:text-white"},Le={class:"flex items-center"},Je={class:"p-3 bg-blue-100 dark:bg-blue-900 rounded-lg"},Re={class:"ml-4"},Oe={class:"flex justify-between items-center"},ze={class:"flex space-x-2"},Ge={key:0,class:"text-center py-8"},He={key:1,class:"text-center py-8"},Ke={key:2,class:"overflow-x-auto"},Qe={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},We={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Xe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"},Ye={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100"},Ze={class:"px-6 py-4 whitespace-nowrap"},et={class:"px-6 py-4 text-sm text-gray-900 dark:text-gray-100"},tt={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},at={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},bt=z({__name:"index",setup(S){const{partners:u,loadPartners:j}=Z(),{getJournalEntries:w,deleteJournalEntry:U}=te(),{notifySuccess:P,notifyError:x}=oe(),f=k(!0),l=k([]),v=k(""),b=k(""),n=k(!1),F=k(null),q=V(()=>[{label:"All Partners",value:""},...u.value.map(e=>({label:e.name,value:e.id}))]),M=[{label:"All Types",value:""},{label:"Credits",value:"credit"},{label:"Debits",value:"debit"}],$=V(()=>{let e=l.value;return v.value&&(e=e.filter(a=>a.partner_id===v.value)),b.value&&(e=e.filter(a=>a.type===b.value)),e.sort((a,c)=>new Date(c.date).getTime()-new Date(a.date).getTime())}),m=V(()=>l.value.filter(e=>e.type==="credit").reduce((e,a)=>e+D(a.amount),0)),s=V(()=>l.value.filter(e=>e.type==="debit").reduce((e,a)=>e+D(a.amount),0)),E=V(()=>m.value-s.value),_=e=>new Date(e).toLocaleDateString(),h=e=>{if(!e)return"No Partner";const a=u.value.find(c=>c.id===e);return(a==null?void 0:a.name)||`Unknown Partner (${e.slice(0,8)}...)`},D=e=>typeof e=="string"?parseFloat(e):e,B=e=>{F.value=e,n.value=!0},L=e=>[[{label:"Edit",icon:"i-heroicons-pencil-square",click:()=>B(e)}],[{label:"Delete",icon:"i-heroicons-trash",click:()=>J(e)}]],J=async e=>{if(confirm(`Are you sure you want to delete this ${e.type} entry?`))try{await U(e.id),await T(),P("Journal entry deleted successfully")}catch{x("Failed to delete journal entry")}},T=async()=>{var e,a;try{f.value=!0,await j(),console.log("Loaded partners:",u.value.map(C=>({id:C.id,name:C.name})));const c=await w();c&&c.data?l.value=Array.isArray(c.data)?c.data:[]:l.value=[],console.log("Loaded entries:",l.value.length),console.log("First entry full data:",l.value[0]),console.log("First entry partner_id:",(e=l.value[0])==null?void 0:e.partner_id),console.log("Partner lookup result:",h((a=l.value[0])==null?void 0:a.partner_id))}catch(c){console.error("Failed to load journal entries:",c),x("Failed to load journal entries"),l.value=[]}finally{f.value=!1}};return ce(T),(e,a)=>{const c=Y,C=G,I=ee,H=ae,ne=me,re=Ee,se=ye,le=Ce;return y(),g("div",Ae,[t("div",Se,[a[4]||(a[4]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Journal Entries"),t("p",{class:"text-gray-600 dark:text-gray-400"},"Manage partner credits, debits, and corrections")],-1)),o(C,{to:"/journal-entries/create",color:"primary"},{default:i(()=>[o(c,{name:"i-heroicons-plus",class:"mr-2"}),a[3]||(a[3]=N(" New Entry ",-1))]),_:1,__:[3]})]),t("div",je,[o(I,null,{default:i(()=>[t("div",Fe,[t("div",Me,[o(c,{name:"i-heroicons-plus-circle",class:"h-6 w-6 text-green-600 dark:text-green-400"})]),t("div",$e,[a[5]||(a[5]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Total Credits",-1)),t("p",Be,"₱"+p(r(m).toLocaleString()),1)])])]),_:1}),o(I,null,{default:i(()=>[t("div",Ie,[t("div",Ne,[o(c,{name:"i-heroicons-minus-circle",class:"h-6 w-6 text-red-600 dark:text-red-400"})]),t("div",Pe,[a[6]||(a[6]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Total Debits",-1)),t("p",qe,"₱"+p(r(s).toLocaleString()),1)])])]),_:1}),o(I,null,{default:i(()=>[t("div",Le,[t("div",Je,[o(c,{name:"i-heroicons-scale",class:"h-6 w-6 text-blue-600 dark:text-blue-400"})]),t("div",Re,[a[7]||(a[7]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Net Balance",-1)),t("p",{class:O(["text-2xl font-bold",r(E)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])}," ₱"+p(Math.abs(r(E)).toLocaleString()),3)])])]),_:1})]),o(I,null,{header:i(()=>[t("div",Oe,[a[8]||(a[8]=t("h3",{class:"text-lg font-semibold"},"Recent Journal Entries",-1)),t("div",ze,[o(H,{modelValue:r(v),"onUpdate:modelValue":a[0]||(a[0]=d=>R(v)?v.value=d:null),options:r(q),placeholder:"All Partners"},null,8,["modelValue","options"]),o(H,{modelValue:r(b),"onUpdate:modelValue":a[1]||(a[1]=d=>R(b)?b.value=d:null),options:M,placeholder:"All Types"},null,8,["modelValue"])])])]),default:i(()=>[r(f)?(y(),g("div",Ge,[o(ne,{message:"Loading journal entries..."})])):r($).length===0?(y(),g("div",He,[o(re,{title:"No journal entries found",message:"Create your first journal entry to track partner credits and debits.","action-text":"Create Entry","action-to":"/journal-entries/create"})])):(y(),g("div",Ke,[t("table",Qe,[a[9]||(a[9]=t("thead",{class:"bg-gray-50 dark:bg-gray-800"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Partner"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Type"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Description"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Amount"),t("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",We,[(y(!0),g(ue,null,pe(r($),d=>(y(),g("tr",{key:d.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[t("td",Xe,p(_(d.date)),1),t("td",Ye,p(h(d.partner_id)),1),t("td",Ze,[t("span",{class:O(["inline-flex px-2 py-1 text-xs font-medium rounded-full",d.type==="credit"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"])},p(d.type==="credit"?"Credit":"Debit"),3)]),t("td",et,[t("div",null,p(d.description),1),d.reference?(y(),g("div",tt," Ref: "+p(d.reference),1)):X("",!0)]),t("td",{class:O(["px-6 py-4 whitespace-nowrap text-sm text-right font-medium",d.type==="credit"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])},p(d.type==="credit"?"+":"-")+"₱"+p(D(d.amount).toLocaleString()),3),t("td",at,[o(se,{items:L(d)},{default:i(()=>[o(C,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal",size:"sm"})]),_:2},1032,["items"])])]))),128))])])]))]),_:1}),o(le,{modelValue:r(n),"onUpdate:modelValue":a[2]||(a[2]=d=>R(n)?n.value=d:null),entry:r(F),onUpdated:T},null,8,["modelValue","entry"])])}}});export{bt as default};
