import{h as k,l as b,r as p,n as w,i as A,c as _,a as t,b as l,w as u,p as B,f as F,o as x,k as P,t as o,j as d,F as C,q as D}from"./DNOTuklV.js";const E={class:"space-y-6"},T={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},j={class:"flex items-center"},I={class:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg"},M={class:"ml-4"},N={class:"text-2xl font-bold text-gray-900 dark:text-white"},U={class:"flex items-center"},V={class:"p-2 bg-green-100 dark:bg-green-900 rounded-lg"},q={class:"ml-4"},L={class:"text-2xl font-bold text-gray-900 dark:text-white"},S={class:"flex items-center"},z={class:"p-2 bg-purple-100 dark:bg-purple-900 rounded-lg"},G={class:"ml-4"},H={class:"text-2xl font-bold text-gray-900 dark:text-white"},J={class:"space-y-4"},K={class:"flex items-center"},O={class:"w-10 h-10 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center"},Q={class:"text-blue-600 dark:text-blue-400 font-semibold"},R={class:"ml-4"},W={class:"font-medium text-gray-900 dark:text-white"},X={class:"text-sm text-gray-500 dark:text-gray-400"},Y={class:"text-right"},Z={class:"font-semibold text-gray-900 dark:text-white"},$={class:"text-sm text-gray-500 dark:text-gray-400"},at=k({__name:"partners",setup(tt){const{partners:i,loadPartners:h}=b(),{getBookings:f}=B(),c=p([]),g=p(0),m=e=>{if(!e)return 0;const s=parseFloat(e.baseAmount||e.base_amount||0),n=(e.addons||[]).reduce((r,a)=>r+(parseFloat(a.amount)||0),0);return s+n},v=w(()=>!Array.isArray(i.value)||i.value.length===0?[]:[...i.value].filter(e=>e&&e.id).map(e=>{const n=c.value.filter(r=>r&&(r.partnerId||r.partner_id)===e.id).reduce((r,a)=>r+m(a),0);return{...e,earnings:n||0}}).sort((e,s)=>(s.earnings||0)-(e.earnings||0))),y=e=>!Array.isArray(c.value)||!e?0:c.value.filter(s=>s&&(s.partnerId||s.partner_id)===e).length;return A(async()=>{try{const[e]=await Promise.all([f(),h()]);c.value=Array.isArray(e)?e:[],g.value=c.value.reduce((s,n)=>s+m(n),0)}catch(e){console.error("Failed to load data:",e)}}),(e,s)=>{const n=P,r=F;return x(),_("div",E,[t("div",T,[l(r,null,{default:u(()=>{var a;return[t("div",j,[t("div",I,[l(n,{name:"i-heroicons-users",class:"h-6 w-6 text-blue-600 dark:text-blue-400"})]),t("div",M,[s[0]||(s[0]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Total Partners",-1)),t("p",N,o(((a=d(i).value)==null?void 0:a.length)||0),1)])])]}),_:1}),l(r,null,{default:u(()=>[t("div",U,[t("div",V,[l(n,{name:"i-heroicons-currency-dollar",class:"h-6 w-6 text-green-600 dark:text-green-400"})]),t("div",q,[s[1]||(s[1]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Total Earnings",-1)),t("p",L,"₱"+o(d(g).toFixed(2)),1)])])]),_:1}),l(r,null,{default:u(()=>{var a;return[t("div",S,[t("div",z,[l(n,{name:"i-heroicons-chart-bar",class:"h-6 w-6 text-purple-600 dark:text-purple-400"})]),t("div",G,[s[2]||(s[2]=t("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Avg per Partner",-1)),t("p",H," ₱"+o((a=d(i).value)!=null&&a.length?(d(g).value/d(i).value.length).toFixed(2):"0.00"),1)])])]}),_:1})]),l(r,null,{header:u(()=>s[3]||(s[3]=[t("h3",{class:"text-lg font-semibold"},"Partners & Earnings",-1)])),default:u(()=>[t("div",J,[(x(!0),_(C,null,D(d(v),a=>(x(),_("div",{key:a.id,class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},[t("div",K,[t("div",O,[t("span",Q,o(a.name.charAt(0)),1)]),t("div",R,[t("h4",W,o(a.name),1),t("p",X,o(y(a.id))+" bookings ",1)])]),t("div",Y,[t("p",Z," ₱"+o(a.earnings.toFixed(2)),1),t("p",$,o((a.earnings/d(g).value*100||0).toFixed(1))+"% ",1)])]))),128))])]),_:1})])}}});export{at as default};
